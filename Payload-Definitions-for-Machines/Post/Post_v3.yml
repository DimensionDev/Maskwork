$schema: http://json-schema.org/draft-07/schema#
description: urn:Maskbook:Post:3
title: urn:Maskbook:Post:3
properties:
    _urn:
        type: string
        description: urn:Maskbook:Post:3:${this.id}
        pattern: urn:Maskbook:Post:3:[0-9A-F]{64}
    _time:
        type: string
        description: ISO 8601 with UTC string (1970-01-01T00:00:00.000Z)
    _updatedAt:
        type: string
        description: ISO 8601 with UTC string (1970-01-01T00:00:00.000Z)
    id:
        type: string
        description: 2 random UUIDv4 strings, uppercase without hyphens
        pattern: [0-9A-F]{64}
    postKey:
        type: string
        description: 128-bit entropy, encoded with Base64; must omit this field when publishing
        alias: 'a1'
    postIv:
        type: string
        description: Post IV, 512-bit PRNG, encoded with Base64 (without trailing padding characters)
        alias: 'a2'
    postLocator:
        type: string
        description: Serialized PostLocator (v2)
        alias: 'a3'
    epheKeys:
        type: object
        description: EcdhEphemeralKeysDict (v1) object
        alias: 'a4'
    recipients:
        type: array
        alias: 'a5'
        allOf:
            type: string
            description: Serialized ProfileGroupIdentifier (v2)
    persona:
        type: string
        alias: 'a6'
        description: Serialized PersonaLocator (v2)
    profile:
        type: string
        description: Serialized ProfileLocator (v2)
    hint:
        type: string
        description: AES.encrypt(this.postKey, persona.localKey).toString(Base64)
    ciphertext:
        type: string
        description: Ciphertext, encoded with Base64
    opportunistKeys:
        type: object
        description: X
        properties:
            bits:
                type: number
                description: How many last bits of respective public keys are used to divide recipient-specific ECDH payloads into groups
                alias: 'a1'
            data:
                type: array
                description:
                allOf:
                    type:
                length: Math.pow(2, this.opportunistKeys.bits)
    pluginDataPub:
        type: object
        description: Each key must be a PluginIdentifier (v1)
    pluginDataSecRaw:
        type: object
        description: Each key must be a PluginIdentifier (v1); must omit this field when publishing
    pluginDataSec:
        type: string
        description: AES.encrypt(BSON.encode(Obj), postKey).toString(Base64)
        binary: base64
